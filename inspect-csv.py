
import csv
import re

file='findings.csv'

def vector_parse(vector_blob):
  return dict(x.split(":") for x in vector_blob.split("/"))

with open(file, 'r') as csv_file:
  csv_reader = csv.DictReader(csv_file, delimiter=',')

  findings_to_alert = []

  for finding in csv_reader:
    # only include critical and high severity issues
    sev_pattern = "(High|Critical)"
    if not re.search(sev_pattern, finding["Severity"]): continue 

    # https://www.first.org/cvss/specification-document
    # AV == attack vector and N == network 
    vector_details = vector_parse(finding["CVSS3 Vector"])
    if vector_details["AV"] == "N":
      findings_to_alert.append(finding)

for issue in findings_to_alert:
  print(issue)
  print("\n")
